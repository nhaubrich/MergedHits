{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas, keras\n",
    "import numpy as np\n",
    "from sklearn.metrics import roc_auc_score\n",
    "from IPython.display import FileLink, FileLinks\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 1 image has 6x6 pixels = 36 pixels \n",
    "###################### Need to try 16 x 16 and 8 x 8 and see the effect (making a heatmap for 3,4 hits), can be changed in Convertroototpand.py\n",
    "pixels = [\"pixel_{0}\".format(i) for i in range(36)]\n",
    "def to_image(df):\n",
    "    return  np.expand_dims(np.expand_dims(df[pixels], axis=-1).reshape(-1,6,6), axis=-1)\n",
    "\n",
    "# replace this sample every time you train CNN\n",
    "store_train = pandas.HDFStore(\"output_final.h5\")\n",
    "\n",
    "# kinda like tree1\n",
    "df = store_train.select(\"df\",stop=-1) \n",
    "\n",
    "#cut on DeltaR and nUniqueSimTracksInSharedHit\n",
    "##################################################### Need to move this to ConvertRoottoPanda.py\n",
    "df = df[(df[\"GenDeltaR\"]<0.1) & (df[\"nUniqueSimTracksInSharedHit\"]>-1)]\n",
    "#images_train = to_image(df_train)\n",
    "\n",
    "\n",
    "# Don't need these since I'm using the same files and splitting it, might be useful if I'm using a training file and a testing file\n",
    "#store_test = pandas.HDFStore(\"pixelTrain30k.h5\") #######\n",
    "#df_test = store_test.select(\"df\",stop=-1)\n",
    "#df_test = df_test[(df_test[\"GenDeltaR\"]<0.1) & (df_test[\"nUniqueSimTracksInSharedHit\"]>-1)]0 if shared hit but not merged, -1 if neither, 1, 2,3 if sahred and merged\n",
    "#images_test = to_image(df_test)\n",
    "#comb = pandas.concat([df_train,df_test])\n",
    "#df_train=comb.sample(frac=0.6) ######\n",
    "##########################################################################\n",
    "\n",
    "# frac=0.5 sets half training and half testing\n",
    "df_train=df.sample(frac=0.5)\n",
    "df_test=df.drop(df_train.index)\n",
    "images_train = to_image(df_train)\n",
    "images_test = to_image(df_test)\n",
    "\n",
    "#***************************************************** Jack's notebook: only include shared hits so 0 events are not included here !\n",
    "# Make all test, train data merged hit\n",
    "#df_test = df_test[(df_test[\"isSharedHit\"]>0)]\n",
    "#df_train = df_train[(df_train[\"isSharedHit\"]>0)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(6044, 42)\n",
      "(6045, 42)\n"
     ]
    }
   ],
   "source": [
    "# Sanity check: printout (events, variables) Variables include 36 pixels, and a few others you can find in converroottopands.py\n",
    "print df_test.shape\n",
    "print df_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train on 5440 samples, validate on 605 samples\n",
      "Epoch 1/100\n",
      "5440/5440 [==============================] - 1s 246us/step - loss: 0.5686 - acc: 0.6987 - val_loss: 0.5496 - val_acc: 0.7124\n",
      "Epoch 2/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.5275 - acc: 0.7101 - val_loss: 0.5193 - val_acc: 0.7207\n",
      "Epoch 3/100\n",
      "5440/5440 [==============================] - 1s 189us/step - loss: 0.5019 - acc: 0.7325 - val_loss: 0.4964 - val_acc: 0.7537\n",
      "Epoch 4/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.4786 - acc: 0.7513 - val_loss: 0.4848 - val_acc: 0.7521\n",
      "Epoch 5/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.4628 - acc: 0.7572 - val_loss: 0.4745 - val_acc: 0.7636\n",
      "Epoch 6/100\n",
      "5440/5440 [==============================] - 1s 178us/step - loss: 0.4548 - acc: 0.7607 - val_loss: 0.4632 - val_acc: 0.7835\n",
      "Epoch 7/100\n",
      "5440/5440 [==============================] - 1s 169us/step - loss: 0.4471 - acc: 0.7601 - val_loss: 0.4740 - val_acc: 0.7653\n",
      "Epoch 8/100\n",
      "5440/5440 [==============================] - 1s 175us/step - loss: 0.4407 - acc: 0.7614 - val_loss: 0.4520 - val_acc: 0.7785\n",
      "Epoch 9/100\n",
      "5440/5440 [==============================] - 1s 173us/step - loss: 0.4335 - acc: 0.7669 - val_loss: 0.4519 - val_acc: 0.7851\n",
      "Epoch 10/100\n",
      "5440/5440 [==============================] - 1s 168us/step - loss: 0.4293 - acc: 0.7761 - val_loss: 0.4466 - val_acc: 0.7884\n",
      "Epoch 11/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.4268 - acc: 0.7695 - val_loss: 0.4442 - val_acc: 0.7934\n",
      "Epoch 12/100\n",
      "5440/5440 [==============================] - 1s 191us/step - loss: 0.4250 - acc: 0.7735 - val_loss: 0.4453 - val_acc: 0.7884\n",
      "Epoch 13/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.4207 - acc: 0.7776 - val_loss: 0.4447 - val_acc: 0.7884\n",
      "Epoch 14/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.4164 - acc: 0.7754 - val_loss: 0.4385 - val_acc: 0.7950\n",
      "Epoch 15/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.4170 - acc: 0.7765 - val_loss: 0.4407 - val_acc: 0.7934\n",
      "Epoch 16/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.4120 - acc: 0.7778 - val_loss: 0.4462 - val_acc: 0.7950\n",
      "Epoch 17/100\n",
      "5440/5440 [==============================] - 1s 192us/step - loss: 0.4114 - acc: 0.7741 - val_loss: 0.4515 - val_acc: 0.7835\n",
      "Epoch 18/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.4093 - acc: 0.7787 - val_loss: 0.4444 - val_acc: 0.7868\n",
      "Epoch 19/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.4049 - acc: 0.7868 - val_loss: 0.4433 - val_acc: 0.7901\n",
      "Epoch 20/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.4010 - acc: 0.7875 - val_loss: 0.4505 - val_acc: 0.7868\n",
      "Epoch 21/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.4052 - acc: 0.7829 - val_loss: 0.4527 - val_acc: 0.7851\n",
      "Epoch 22/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3975 - acc: 0.7842 - val_loss: 0.4575 - val_acc: 0.7785\n",
      "Epoch 23/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.4019 - acc: 0.7858 - val_loss: 0.4500 - val_acc: 0.7835\n",
      "Epoch 24/100\n",
      "5440/5440 [==============================] - 1s 190us/step - loss: 0.3983 - acc: 0.7904 - val_loss: 0.4531 - val_acc: 0.7868\n",
      "Epoch 25/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.3957 - acc: 0.7888 - val_loss: 0.4497 - val_acc: 0.7868\n",
      "Epoch 26/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3961 - acc: 0.7864 - val_loss: 0.4531 - val_acc: 0.7967\n",
      "Epoch 27/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3960 - acc: 0.7855 - val_loss: 0.4482 - val_acc: 0.7868\n",
      "Epoch 28/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3925 - acc: 0.7892 - val_loss: 0.4467 - val_acc: 0.7901\n",
      "Epoch 29/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3912 - acc: 0.7899 - val_loss: 0.4500 - val_acc: 0.7851\n",
      "Epoch 30/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3895 - acc: 0.7895 - val_loss: 0.4598 - val_acc: 0.7702\n",
      "Epoch 31/100\n",
      "5440/5440 [==============================] - 1s 149us/step - loss: 0.3903 - acc: 0.7892 - val_loss: 0.4438 - val_acc: 0.7884\n",
      "Epoch 32/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3906 - acc: 0.7906 - val_loss: 0.4522 - val_acc: 0.7884\n",
      "Epoch 33/100\n",
      "5440/5440 [==============================] - 1s 191us/step - loss: 0.3846 - acc: 0.7941 - val_loss: 0.4495 - val_acc: 0.7934\n",
      "Epoch 34/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.3849 - acc: 0.7928 - val_loss: 0.4474 - val_acc: 0.7636\n",
      "Epoch 35/100\n",
      "5440/5440 [==============================] - 1s 181us/step - loss: 0.3835 - acc: 0.7972 - val_loss: 0.4689 - val_acc: 0.7835\n",
      "Epoch 36/100\n",
      "5440/5440 [==============================] - 1s 173us/step - loss: 0.3825 - acc: 0.7926 - val_loss: 0.4565 - val_acc: 0.7818\n",
      "Epoch 37/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3824 - acc: 0.7956 - val_loss: 0.4510 - val_acc: 0.7868\n",
      "Epoch 38/100\n",
      "5440/5440 [==============================] - 1s 190us/step - loss: 0.3772 - acc: 0.7974 - val_loss: 0.4484 - val_acc: 0.8017\n",
      "Epoch 39/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3763 - acc: 0.7987 - val_loss: 0.4521 - val_acc: 0.8000\n",
      "Epoch 40/100\n",
      "5440/5440 [==============================] - 1s 182us/step - loss: 0.3773 - acc: 0.7960 - val_loss: 0.4492 - val_acc: 0.7917\n",
      "Epoch 41/100\n",
      "5440/5440 [==============================] - 1s 190us/step - loss: 0.3794 - acc: 0.7926 - val_loss: 0.4499 - val_acc: 0.7884\n",
      "Epoch 42/100\n",
      "5440/5440 [==============================] - 1s 192us/step - loss: 0.3727 - acc: 0.7985 - val_loss: 0.4549 - val_acc: 0.8017\n",
      "Epoch 43/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.3743 - acc: 0.7965 - val_loss: 0.4537 - val_acc: 0.7917\n",
      "Epoch 44/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3714 - acc: 0.8015 - val_loss: 0.4501 - val_acc: 0.7934\n",
      "Epoch 45/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3708 - acc: 0.7989 - val_loss: 0.4603 - val_acc: 0.7868\n",
      "Epoch 46/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3676 - acc: 0.8050 - val_loss: 0.4530 - val_acc: 0.8000\n",
      "Epoch 47/100\n",
      "5440/5440 [==============================] - 1s 190us/step - loss: 0.3680 - acc: 0.8035 - val_loss: 0.4515 - val_acc: 0.7868\n",
      "Epoch 48/100\n",
      "5440/5440 [==============================] - 1s 189us/step - loss: 0.3669 - acc: 0.8040 - val_loss: 0.4677 - val_acc: 0.7950\n",
      "Epoch 49/100\n",
      "5440/5440 [==============================] - 1s 177us/step - loss: 0.3647 - acc: 0.8031 - val_loss: 0.4597 - val_acc: 0.7884\n",
      "Epoch 50/100\n",
      "5440/5440 [==============================] - 1s 193us/step - loss: 0.3667 - acc: 0.8011 - val_loss: 0.4585 - val_acc: 0.8066\n",
      "Epoch 51/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3670 - acc: 0.7985 - val_loss: 0.4517 - val_acc: 0.7917\n",
      "Epoch 52/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3640 - acc: 0.8059 - val_loss: 0.4584 - val_acc: 0.7967\n",
      "Epoch 53/100\n",
      "5440/5440 [==============================] - 1s 193us/step - loss: 0.3621 - acc: 0.8053 - val_loss: 0.4660 - val_acc: 0.7769\n",
      "Epoch 54/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.3590 - acc: 0.8090 - val_loss: 0.4534 - val_acc: 0.7934\n",
      "Epoch 55/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3601 - acc: 0.8116 - val_loss: 0.4440 - val_acc: 0.7950\n",
      "Epoch 56/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3629 - acc: 0.8031 - val_loss: 0.4402 - val_acc: 0.7901\n",
      "Epoch 57/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3584 - acc: 0.8039 - val_loss: 0.4532 - val_acc: 0.7983\n",
      "Epoch 58/100\n",
      "5440/5440 [==============================] - 1s 195us/step - loss: 0.3552 - acc: 0.8077 - val_loss: 0.4585 - val_acc: 0.7752\n",
      "Epoch 59/100\n",
      "5440/5440 [==============================] - 1s 182us/step - loss: 0.3533 - acc: 0.8123 - val_loss: 0.4687 - val_acc: 0.7818\n",
      "Epoch 60/100\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3521 - acc: 0.8074 - val_loss: 0.4613 - val_acc: 0.7967\n",
      "Epoch 61/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3560 - acc: 0.8068 - val_loss: 0.4664 - val_acc: 0.7868\n",
      "Epoch 62/100\n",
      "5440/5440 [==============================] - 1s 182us/step - loss: 0.3518 - acc: 0.8116 - val_loss: 0.4613 - val_acc: 0.7967\n",
      "Epoch 63/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3477 - acc: 0.8086 - val_loss: 0.4613 - val_acc: 0.7719\n",
      "Epoch 64/100\n",
      "5440/5440 [==============================] - 1s 181us/step - loss: 0.3526 - acc: 0.8112 - val_loss: 0.4607 - val_acc: 0.7917\n",
      "Epoch 65/100\n",
      "5440/5440 [==============================] - 1s 181us/step - loss: 0.3495 - acc: 0.8112 - val_loss: 0.4494 - val_acc: 0.7983\n",
      "Epoch 66/100\n",
      "5440/5440 [==============================] - 1s 172us/step - loss: 0.3469 - acc: 0.8138 - val_loss: 0.4577 - val_acc: 0.7835\n",
      "Epoch 67/100\n",
      "5440/5440 [==============================] - 1s 175us/step - loss: 0.3516 - acc: 0.8088 - val_loss: 0.4575 - val_acc: 0.7851\n",
      "Epoch 68/100\n",
      "5440/5440 [==============================] - 1s 167us/step - loss: 0.3507 - acc: 0.8057 - val_loss: 0.4644 - val_acc: 0.7851\n",
      "Epoch 69/100\n",
      "5440/5440 [==============================] - 1s 169us/step - loss: 0.3472 - acc: 0.8110 - val_loss: 0.4639 - val_acc: 0.7967\n",
      "Epoch 70/100\n",
      "5440/5440 [==============================] - 1s 178us/step - loss: 0.3436 - acc: 0.8119 - val_loss: 0.4466 - val_acc: 0.7934\n",
      "Epoch 71/100\n",
      "5440/5440 [==============================] - 1s 181us/step - loss: 0.3424 - acc: 0.8110 - val_loss: 0.4601 - val_acc: 0.7802\n",
      "Epoch 72/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.3402 - acc: 0.8160 - val_loss: 0.4524 - val_acc: 0.7934\n",
      "Epoch 73/100\n",
      "5440/5440 [==============================] - 1s 181us/step - loss: 0.3414 - acc: 0.8176 - val_loss: 0.4670 - val_acc: 0.7851\n",
      "Epoch 74/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3368 - acc: 0.8165 - val_loss: 0.4593 - val_acc: 0.7967\n",
      "Epoch 75/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3381 - acc: 0.8136 - val_loss: 0.4708 - val_acc: 0.7736\n",
      "Epoch 76/100\n",
      "5440/5440 [==============================] - 1s 203us/step - loss: 0.3398 - acc: 0.8121 - val_loss: 0.4593 - val_acc: 0.7983\n",
      "Epoch 77/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3394 - acc: 0.8154 - val_loss: 0.4655 - val_acc: 0.7802\n",
      "Epoch 78/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3352 - acc: 0.8184 - val_loss: 0.4499 - val_acc: 0.7950\n",
      "Epoch 79/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3384 - acc: 0.8116 - val_loss: 0.4660 - val_acc: 0.7917\n",
      "Epoch 80/100\n",
      "5440/5440 [==============================] - 1s 185us/step - loss: 0.3411 - acc: 0.8145 - val_loss: 0.4623 - val_acc: 0.7818\n",
      "Epoch 81/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.3368 - acc: 0.8143 - val_loss: 0.4683 - val_acc: 0.8000\n",
      "Epoch 82/100\n",
      "5440/5440 [==============================] - 1s 179us/step - loss: 0.3346 - acc: 0.8224 - val_loss: 0.4691 - val_acc: 0.7802\n",
      "Epoch 83/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.3340 - acc: 0.8153 - val_loss: 0.4656 - val_acc: 0.7835\n",
      "Epoch 84/100\n",
      "5440/5440 [==============================] - 1s 187us/step - loss: 0.3334 - acc: 0.8173 - val_loss: 0.4552 - val_acc: 0.7736\n",
      "Epoch 85/100\n",
      "5440/5440 [==============================] - 1s 182us/step - loss: 0.3349 - acc: 0.8151 - val_loss: 0.4609 - val_acc: 0.7719\n",
      "Epoch 86/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3292 - acc: 0.8186 - val_loss: 0.4735 - val_acc: 0.7868\n",
      "Epoch 87/100\n",
      "5440/5440 [==============================] - 1s 188us/step - loss: 0.3288 - acc: 0.8189 - val_loss: 0.4573 - val_acc: 0.7851\n",
      "Epoch 88/100\n",
      "5440/5440 [==============================] - 1s 194us/step - loss: 0.3306 - acc: 0.8222 - val_loss: 0.4744 - val_acc: 0.7868\n",
      "Epoch 89/100\n",
      "5440/5440 [==============================] - 1s 172us/step - loss: 0.3293 - acc: 0.8252 - val_loss: 0.4709 - val_acc: 0.7785\n",
      "Epoch 90/100\n",
      "5440/5440 [==============================] - 1s 182us/step - loss: 0.3292 - acc: 0.8197 - val_loss: 0.4689 - val_acc: 0.7769\n",
      "Epoch 91/100\n",
      "5440/5440 [==============================] - 1s 143us/step - loss: 0.3270 - acc: 0.8197 - val_loss: 0.4756 - val_acc: 0.7752\n",
      "Epoch 92/100\n",
      "5440/5440 [==============================] - 1s 166us/step - loss: 0.3261 - acc: 0.8167 - val_loss: 0.4776 - val_acc: 0.7719\n",
      "Epoch 93/100\n",
      "5440/5440 [==============================] - 1s 165us/step - loss: 0.3265 - acc: 0.8164 - val_loss: 0.4818 - val_acc: 0.7752\n",
      "Epoch 94/100\n",
      "5440/5440 [==============================] - 1s 167us/step - loss: 0.3243 - acc: 0.8237 - val_loss: 0.4777 - val_acc: 0.7884\n",
      "Epoch 95/100\n",
      "5440/5440 [==============================] - 1s 175us/step - loss: 0.3250 - acc: 0.8204 - val_loss: 0.4883 - val_acc: 0.7603\n",
      "Epoch 96/100\n",
      "5440/5440 [==============================] - 1s 174us/step - loss: 0.3245 - acc: 0.8180 - val_loss: 0.4878 - val_acc: 0.7818\n",
      "Epoch 97/100\n",
      "5440/5440 [==============================] - 1s 183us/step - loss: 0.3255 - acc: 0.8210 - val_loss: 0.4668 - val_acc: 0.7835\n",
      "Epoch 98/100\n",
      "5440/5440 [==============================] - 1s 184us/step - loss: 0.3231 - acc: 0.8241 - val_loss: 0.4706 - val_acc: 0.7917\n",
      "Epoch 99/100\n",
      "5440/5440 [==============================] - 1s 186us/step - loss: 0.3197 - acc: 0.8226 - val_loss: 0.4756 - val_acc: 0.7736\n",
      "Epoch 100/100\n",
      "5440/5440 [==============================] - 1s 190us/step - loss: 0.3213 - acc: 0.8202 - val_loss: 0.4784 - val_acc: 0.7818\n",
      "<bound method Sequential.summary of <keras.engine.sequential.Sequential object at 0x7fc842e9b910>>\n"
     ]
    }
   ],
   "source": [
    "# This is the CNN\n",
    "# Adding layers to Neural Network: (1) is convolutional,(1.5) 2D layer ,(2) flatten output then feed it to (3) which is a regular neural network.\n",
    "# (4) drops nodes in NN to avoid overfitting, finallly (5) outputs 2 values (prob(merged hit), prob(notmergedhit)), should add up to 1\n",
    "\n",
    "from keras.layers import Dense, Dropout, Activation\n",
    "# Define the network\n",
    "model = keras.models.Sequential()\n",
    "\n",
    "#layer (1)\n",
    "model.add(keras.layers.Conv2D(32, kernel_size=(4,4), padding='same', activation='relu'))\n",
    "\n",
    "#layer (1.5)\n",
    "############################################## 2D layers: need to add these back individually and see their effect\n",
    "#********************************************# what does this layer do again ?\n",
    "#model.add(keras.layers.Conv2D(16, kernel_size=(4,4), padding='same', activation='relu'))\n",
    "#model.add(keras.layers.Conv2D(16, kernel_size=(2,2), padding='same', activation='relu'))\n",
    "#model.add(keras.layers.Conv2D(16, kernel_size=(1,1), padding='same', activation='relu'))\n",
    "\n",
    "# max pooling 2D\n",
    "#model.add(keras.layers.MaxPooling2D(pool_size=(2, 2), padding='same', data_format=\"channels_last\"))\n",
    "\n",
    "# layer (2)\n",
    "model.add(keras.layers.Flatten(input_shape=(6,6,1),data_format = \"channels_last\"))\n",
    "#model.add(keras.layers.Dense(200, activation='relu'))\n",
    "\n",
    "# layer (3)\n",
    "model.add(keras.layers.Dense(50, activation='relu'))\n",
    "\n",
    "# layer 4, dropout 10%\n",
    "model.add(Dropout(0.1))\n",
    "model.add(keras.layers.Dense(2, activation='softmax'))\n",
    "#print(model.summary())\n",
    "                                                    \n",
    "# Layer (5), train the network\n",
    "###############################################################  try to find a way to include pt, eta, phi after first layer (convolutional)\n",
    "############################################################### tru to make a plot of loss[i]/epoch[i] to see when you get a plateau, which means\n",
    "# optimal number of epochs, var name might be model.loss.\n",
    "model.compile(loss='categorical_crossentropy', optimizer=\"adam\", metrics = [\"accuracy\"]) \n",
    "model.fit(images_train, keras.utils.to_categorical(df_train[\"nUniqueSimTracksInSharedHit\"]>1), epochs=100, validation_split=0.1) \n",
    "# validation fraction is fraction of training sample used for testing (here 10%), epochs: number of times you run the CNN.\n",
    "print(model.summary)  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Running on full test sample. This may take a moment.\n",
      "[[2.7453501e-04 9.9972540e-01]\n",
      " [6.9648807e-04 9.9930346e-01]\n",
      " [4.2558018e-02 9.5744199e-01]\n",
      " ...\n",
      " [1.6833817e-04 9.9983168e-01]\n",
      " [3.2290253e-01 6.7709750e-01]\n",
      " [8.2147855e-01 1.7852145e-01]]\n"
     ]
    }
   ],
   "source": [
    "# Evaluate performance on independent sample, un CNN on Test sample\n",
    "print(\"Running on full test sample. This may take a moment.\")\n",
    "ret = model.predict(images_test)\n",
    "np.save(\"result.npy\",ret[:,1])\n",
    "print(ret)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.         0.00106952 0.00106952 ... 0.98770053 0.98877005 1.        ] [0.         0.03449928 0.04743651 ... 1.         1.         1.        ]\n",
      "0.8442986760413971\n",
      "False\n",
      "1818 1818\n"
     ]
    }
   ],
   "source": [
    "# evaluating ROC curve inputs\n",
    "from sklearn.metrics import roc_curve\n",
    "#fpr_keras, tpr_keras, thresholds_keras = roc_curve(keras.utils.to_categorical(df_test[\"isSharedHit\"])[:,1], ret[:,1])\n",
    "fpr_keras, tpr_keras, thresholds_keras = roc_curve(keras.utils.to_categorical(df_test[\"nUniqueSimTracksInSharedHit\"]>1)[:,1], ret[:,1])\n",
    "\n",
    "print fpr_keras,tpr_keras\n",
    "from sklearn.metrics import auc\n",
    "auc_keras = auc(fpr_keras, tpr_keras)\n",
    "print auc_keras\n",
    "print np.isnan(fpr_keras).all()\n",
    "print len(fpr_keras),len(tpr_keras)\n",
    "np.save(\"fpr_keras.npy\",fpr_keras)\n",
    "np.save(\"tpr_keras.npy\",tpr_keras)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.8442986760413971\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Plotting ROC curve\n",
    "\n",
    "fpr_keras = np.load(\"fpr_keras.npy\")\n",
    "tpr_keras = np.load(\"tpr_keras.npy\")\n",
    "auc = np.trapz(tpr_keras,fpr_keras)\n",
    "print auc\n",
    "\n",
    "plt.figure(1)\n",
    "plt.plot(fpr_keras, tpr_keras, label='Keras (area = {:.3f})'.format(auc))\n",
    "plt.xlabel('False positive rate')\n",
    "plt.ylabel('True positive rate')\n",
    "plt.title('ROC curve (area = {:.3f})'.format(auc))\n",
    "plt.savefig(\"ROC.png\")\n",
    "plt.savefig(\"ROC.pdf\")\n",
    "plt.show() \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pixel_14</th>\n",
       "      <th>pixel_15</th>\n",
       "      <th>pixel_16</th>\n",
       "      <th>pixel_17</th>\n",
       "      <th>pixel_10</th>\n",
       "      <th>pixel_11</th>\n",
       "      <th>pixel_12</th>\n",
       "      <th>pixel_13</th>\n",
       "      <th>pixel_18</th>\n",
       "      <th>pixel_19</th>\n",
       "      <th>...</th>\n",
       "      <th>trackPhi</th>\n",
       "      <th>trackPt</th>\n",
       "      <th>GenDeltaR</th>\n",
       "      <th>isSharedHit</th>\n",
       "      <th>pixel_32</th>\n",
       "      <th>pixel_33</th>\n",
       "      <th>pixel_30</th>\n",
       "      <th>pixel_31</th>\n",
       "      <th>pixel_34</th>\n",
       "      <th>pixel_35</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>0 rows Ã— 42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [pixel_14, pixel_15, pixel_16, pixel_17, pixel_10, pixel_11, pixel_12, pixel_13, pixel_18, pixel_19, pixel_2, pixel_3, pixel_0, pixel_1, pixel_6, pixel_7, pixel_4, pixel_5, pixel_8, pixel_9, nUniqueSimTracksInSharedHit, trackEta, pixel_29, pixel_28, pixel_25, pixel_24, pixel_27, pixel_26, pixel_21, pixel_20, pixel_23, pixel_22, trackPhi, trackPt, GenDeltaR, isSharedHit, pixel_32, pixel_33, pixel_30, pixel_31, pixel_34, pixel_35]\n",
       "Index: []\n",
       "\n",
       "[0 rows x 42 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sanity check: no overlap between train and test \n",
    "pandas.merge(df_train, df_test, on=[x for x in df_train.columns], how='inner')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "shared hits with at least 2 sim tracks:\n",
      "0.697932175352\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Text(0.5,1,'nUniqueSimTracksInSharedHit')"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# visualizing our data\n",
    "print \"shared hits with at least 2 sim tracks:\"\n",
    "print float(sum(df_train[\"nUniqueSimTracksInSharedHit\"]>1))/len(df_train[\"nUniqueSimTracksInSharedHit\"])\n",
    "plt.hist(df_train[\"nUniqueSimTracksInSharedHit\"],histtype=\"step\",bins=6,range=(-0.5,5.5))\n",
    "plt.title(\"nUniqueSimTracksInSharedHit\") "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.697932175352\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Visualizing merged (2 or more) vs not merged (1 or 0 (?)) \n",
    "################################################################ Look at events with nUniqueSimTracksInSharedHit = 0(seem to be uncategorized ?)\n",
    "print float(sum(df_train[\"nUniqueSimTracksInSharedHit\"]>1))/len(df_train[\"nUniqueSimTracksInSharedHit\"])\n",
    "plt.hist(df_train[\"nUniqueSimTracksInSharedHit\"]>1,histtype=\"step\",bins=2,range=(-0.5,1.5))\n",
    "plt.title(\"Distribution of Hits in Training Data\")\n",
    "plt.xticks([0,1],(\"Not Merged\",\"Merged\"))\n",
    "plt.savefig(\"merged_dist.png\")\n",
    "plt.savefig(\"merged_dist.pdf\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "############################################ Add plots of training vs testing for sig and background, can be found in Jack's code"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>isMergedHit</th>\n",
       "      <th>isMergedHit</th>\n",
       "      <th>isMergedHit</th>\n",
       "      <th>isMergedHit</th>\n",
       "      <th>pixel_14</th>\n",
       "      <th>pixel_15</th>\n",
       "      <th>pixel_16</th>\n",
       "      <th>pixel_17</th>\n",
       "      <th>pixel_10</th>\n",
       "      <th>pixel_11</th>\n",
       "      <th>...</th>\n",
       "      <th>trackPhi</th>\n",
       "      <th>trackPt</th>\n",
       "      <th>GenDeltaR</th>\n",
       "      <th>isSharedHit</th>\n",
       "      <th>pixel_32</th>\n",
       "      <th>pixel_33</th>\n",
       "      <th>pixel_30</th>\n",
       "      <th>pixel_31</th>\n",
       "      <th>pixel_34</th>\n",
       "      <th>pixel_35</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.219716</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2.596264</td>\n",
       "      <td>2.596264</td>\n",
       "      <td>0.009700</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>67</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.065272</td>\n",
       "      <td>0.070521</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.086922</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>3.276280</td>\n",
       "      <td>3.276280</td>\n",
       "      <td>0.010255</td>\n",
       "      <td>1</td>\n",
       "      <td>0.053123</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.072779</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.275286</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.432882</td>\n",
       "      <td>1.432882</td>\n",
       "      <td>0.006098</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.246602</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>121</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.270629</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.438324</td>\n",
       "      <td>1.438324</td>\n",
       "      <td>0.006041</td>\n",
       "      <td>1</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.235437</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.208246</td>\n",
       "      <td>0.215681</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.497626</td>\n",
       "      <td>0.497626</td>\n",
       "      <td>0.009110</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 46 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     isMergedHit  isMergedHit  isMergedHit  isMergedHit  pixel_14  pixel_15  \\\n",
       "28             1            1            1            1       0.0  0.219716   \n",
       "67             1            1            1            1       0.0  0.065272   \n",
       "102            1            1            1            1       0.0  0.275286   \n",
       "121            1            1            1            1       0.0  0.270629   \n",
       "149            0            0            0            0       0.0  0.208246   \n",
       "\n",
       "     pixel_16  pixel_17  pixel_10  pixel_11    ...     trackPhi   trackPt  \\\n",
       "28   0.000000       0.0  0.000000       0.0    ...     2.596264  2.596264   \n",
       "67   0.070521       0.0  0.086922       0.0    ...     3.276280  3.276280   \n",
       "102  0.000000       0.0  0.000000       0.0    ...     1.432882  1.432882   \n",
       "121  0.000000       0.0  0.000000       0.0    ...     1.438324  1.438324   \n",
       "149  0.215681       0.0  0.000000       0.0    ...     0.497626  0.497626   \n",
       "\n",
       "     GenDeltaR  isSharedHit  pixel_32  pixel_33  pixel_30  pixel_31  pixel_34  \\\n",
       "28    0.009700            1  0.000000  0.000000       0.0       0.0  0.000000   \n",
       "67    0.010255            1  0.053123  0.000000       0.0       0.0  0.072779   \n",
       "102   0.006098            1  0.000000  0.246602       0.0       0.0  0.000000   \n",
       "121   0.006041            1  0.000000  0.235437       0.0       0.0  0.000000   \n",
       "149   0.009110            0  0.000000  0.000000       0.0       0.0  0.000000   \n",
       "\n",
       "     pixel_35  \n",
       "28        0.0  \n",
       "67        0.0  \n",
       "102       0.0  \n",
       "121       0.0  \n",
       "149       0.0  \n",
       "\n",
       "[5 rows x 46 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Adding isMergedHit column , not necessary\n",
    "############# DO NOT RUN THIS !!! #############################\n",
    "\n",
    "# for train\n",
    "merged_hit = df_train[\"nUniqueSimTracksInSharedHit\"]>1\n",
    "merged_int = merged_hit.astype(int)\n",
    "df_train.insert(0, \"isMergedHit\", merged_int, True)\n",
    "\n",
    "# for test\n",
    "merged_hit_test = df_test[\"nUniqueSimTracksInSharedHit\"]>1\n",
    "merged_int_test = merged_hit_test.astype(int)\n",
    "df_test.insert(0, \"isMergedHit\", merged_int_test, True)\n",
    "\n",
    "df_test.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Separating signal and background for train and test data\n",
    "signal = ret[df_test[\"nUniqueSimTracksInSharedHit\"]>1]\n",
    "background = ret[df_test[\"nUniqueSimTracksInSharedHit\"]<2]\n",
    "\n",
    "signal_plt = signal[:,1]\n",
    "background_plt = background[:,1]\n",
    "\n",
    "ret_train = model.predict(images_train)\n",
    "\n",
    "signal_train = ret_train[df_train[\"nUniqueSimTracksInSharedHit\"]>1]\n",
    "background_train = ret_train[df_train[\"nUniqueSimTracksInSharedHit\"]<2]\n",
    "signal_train_plt = signal_train[:,1]\n",
    "background_train_plt = background_train[:,1]\n",
    "\n",
    "Y_back_hist = np.histogram(background_train_plt, bins = 30, range = (0,1))[0]\n",
    "X_back_hist = np.histogram(background_train_plt, bins = 30, range = (0,1))[1]\n",
    "\n",
    "Y_sig_hist = np.histogram(signal_train_plt, bins = 30, range = (0,1))[0]\n",
    "X_sig_hist = np.histogram(signal_train_plt, bins = 30, range = (0,1))[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[False  True]\n"
     ]
    }
   ],
   "source": [
    "print ret_train > .46"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        pixel_14  pixel_15  pixel_16  pixel_17  pixel_10  pixel_11  pixel_12  \\\n",
      "154947  0.000000  0.152944  0.116939       0.0  0.000000       0.0       0.0   \n",
      "261354  0.000000  0.161311  0.000000       0.0  0.000000       0.0       0.0   \n",
      "234574  0.074901  0.031842  0.017514       0.0  0.073557       0.0       0.0   \n",
      "105238  0.000000  0.124183  0.000000       0.0  0.000000       0.0       0.0   \n",
      "33906   0.000000  0.262506  0.130613       0.0  0.312749       0.0       0.0   \n",
      "92879   0.164347  0.208786  0.000000       0.0  0.000000       0.0       0.0   \n",
      "244386  0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "267040  0.056227  0.114749  0.000000       0.0  0.000000       0.0       0.0   \n",
      "223854  0.050923  0.000000  0.081249       0.0  0.086593       0.0       0.0   \n",
      "40792   0.000000  0.052540  0.000000       0.0  0.000000       0.0       0.0   \n",
      "46487   0.082039  0.060541  0.000000       0.0  0.000000       0.0       0.0   \n",
      "30017   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "86040   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "73807   0.261621  0.069921  0.000000       0.0  0.000000       0.0       0.0   \n",
      "298170  0.181610  0.043324  0.103623       0.0  0.000000       0.0       0.0   \n",
      "214106  0.000000  0.190478  0.000000       0.0  0.000000       0.0       0.0   \n",
      "219253  0.075397  0.293875  0.000000       0.0  0.000000       0.0       0.0   \n",
      "37878   0.000000  0.172661  0.000000       0.0  0.000000       0.0       0.0   \n",
      "257524  0.000000  0.127867  0.107521       0.0  0.076320       0.0       0.0   \n",
      "145120  0.000000  0.487297  0.000000       0.0  0.000000       0.0       0.0   \n",
      "35983   0.000000  0.371017  0.000000       0.0  0.000000       0.0       0.0   \n",
      "260950  0.000000  0.028060  0.159677       0.0  0.184100       0.0       0.0   \n",
      "226103  0.000000  0.152488  0.000000       0.0  0.000000       0.0       0.0   \n",
      "219705  0.000000  0.097535  0.153235       0.0  0.100445       0.0       0.0   \n",
      "179244  0.000000  0.143858  0.000000       0.0  0.000000       0.0       0.0   \n",
      "116854  0.000000  0.132687  0.000000       0.0  0.000000       0.0       0.0   \n",
      "63193   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "142081  0.038738  0.259906  0.000000       0.0  0.000000       0.0       0.0   \n",
      "255803  0.476673  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "227974  0.000000  0.217159  0.000000       0.0  0.000000       0.0       0.0   \n",
      "...          ...       ...       ...       ...       ...       ...       ...   \n",
      "8784    0.000000  0.233151  0.000000       0.0  0.000000       0.0       0.0   \n",
      "43903   0.000000  0.389759  0.000000       0.0  0.000000       0.0       0.0   \n",
      "31897   0.000000  0.107349  0.000000       0.0  0.000000       0.0       0.0   \n",
      "171029  0.000000  0.106049  0.000000       0.0  0.000000       0.0       0.0   \n",
      "142317  0.155491  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "220126  0.000000  0.202570  0.000000       0.0  0.000000       0.0       0.0   \n",
      "18372   0.047062  0.205102  0.000000       0.0  0.000000       0.0       0.0   \n",
      "46206   0.000000  0.423429  0.000000       0.0  0.000000       0.0       0.0   \n",
      "44309   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "142434  0.000000  0.425686  0.000000       0.0  0.000000       0.0       0.0   \n",
      "179831  0.000000  0.476509  0.000000       0.0  0.000000       0.0       0.0   \n",
      "275308  0.000000  0.366503  0.087033       0.0  0.000000       0.0       0.0   \n",
      "200110  0.000000  0.000000  0.278156       0.0  0.000000       0.0       0.0   \n",
      "185623  0.000000  0.105450  0.000000       0.0  0.000000       0.0       0.0   \n",
      "14426   0.000000  0.347266  0.000000       0.0  0.000000       0.0       0.0   \n",
      "11167   0.000000  0.000000  0.484717       0.0  0.000000       0.0       0.0   \n",
      "61128   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "1005    0.340095  0.081370  0.000000       0.0  0.000000       0.0       0.0   \n",
      "47774   0.000000  0.074604  0.193971       0.0  0.141345       0.0       0.0   \n",
      "278402  0.124377  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "227534  0.000000  0.000000  0.436585       0.0  0.000000       0.0       0.0   \n",
      "284050  0.000000  0.000000  0.218218       0.0  0.000000       0.0       0.0   \n",
      "43045   0.053419  0.181907  0.000000       0.0  0.000000       0.0       0.0   \n",
      "58464   0.000000  0.085957  0.000000       0.0  0.000000       0.0       0.0   \n",
      "125188  0.000000  0.325365  0.000000       0.0  0.000000       0.0       0.0   \n",
      "158318  0.000000  0.000000  0.288368       0.0  0.000000       0.0       0.0   \n",
      "164881  0.000000  0.435473  0.000000       0.0  0.000000       0.0       0.0   \n",
      "294608  0.000000  0.357078  0.000000       0.0  0.100988       0.0       0.0   \n",
      "139041  0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "86161   0.000000  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "\n",
      "        pixel_13  pixel_18  pixel_19    ...      trackPhi    trackPt  \\\n",
      "154947  0.000000       0.0  0.000000    ...      1.695997   1.695997   \n",
      "261354  0.000000       0.0  0.000000    ...      1.729843   1.729843   \n",
      "234574  0.000000       0.0  0.000000    ...      1.384978   1.384978   \n",
      "105238  0.000000       0.0  0.000000    ...      2.502795   2.502795   \n",
      "33906   0.000000       0.0  0.000000    ...      3.927353   3.927353   \n",
      "92879   0.000000       0.0  0.000000    ...      1.697028   1.697028   \n",
      "244386  0.000000       0.0  0.000000    ...      9.535042   9.535042   \n",
      "267040  0.000000       0.0  0.000000    ...      1.323129   1.323129   \n",
      "223854  0.000000       0.0  0.000000    ...      3.222042   3.222042   \n",
      "40792   0.000000       0.0  0.000000    ...     31.792377  31.792377   \n",
      "46487   0.000000       0.0  0.000000    ...     30.380339  30.380339   \n",
      "30017   0.000000       0.0  0.000000    ...      1.354223   1.354223   \n",
      "86040   0.000000       0.0  0.000000    ...      9.038250   9.038250   \n",
      "73807   0.000000       0.0  0.000000    ...      2.767694   2.767694   \n",
      "298170  0.000000       0.0  0.000000    ...      1.262088   1.262088   \n",
      "214106  0.000000       0.0  0.000000    ...      4.367934   4.367934   \n",
      "219253  0.000000       0.0  0.000000    ...      2.532604   2.532604   \n",
      "37878   0.000000       0.0  0.000000    ...     18.090032  18.090032   \n",
      "257524  0.000000       0.0  0.000000    ...      2.394998   2.394998   \n",
      "145120  0.000000       0.0  0.000000    ...      0.638655   0.638655   \n",
      "35983   0.000000       0.0  0.000000    ...      6.476088   6.476088   \n",
      "260950  0.000000       0.0  0.000000    ...      1.314161   1.314161   \n",
      "226103  0.000000       0.0  0.000000    ...      3.266872   3.266872   \n",
      "219705  0.000000       0.0  0.000000    ...     18.658000  18.658000   \n",
      "179244  0.000000       0.0  0.000000    ...      1.841388   1.841388   \n",
      "116854  0.000000       0.0  0.000000    ...      5.225543   5.225543   \n",
      "63193   0.000000       0.0  0.000000    ...      3.716930   3.716930   \n",
      "142081  0.000000       0.0  0.000000    ...      5.655678   5.655678   \n",
      "255803  0.000000       0.0  0.000000    ...      3.031010   3.031010   \n",
      "227974  0.000000       0.0  0.000000    ...      1.921699   1.921699   \n",
      "...          ...       ...       ...    ...           ...        ...   \n",
      "8784    0.000000       0.0  0.000000    ...      5.415904   5.415904   \n",
      "43903   0.000000       0.0  0.000000    ...     23.064879  23.064879   \n",
      "31897   0.109513       0.0  0.000000    ...     10.698331  10.698331   \n",
      "171029  0.000000       0.0  0.000000    ...     16.713398  16.713398   \n",
      "142317  0.000000       0.0  0.000000    ...     14.564973  14.564973   \n",
      "220126  0.000000       0.0  0.000000    ...     15.824515  15.824515   \n",
      "18372   0.000000       0.0  0.000000    ...      2.071131   2.071131   \n",
      "46206   0.000000       0.0  0.000000    ...      1.763240   1.763240   \n",
      "44309   0.000000       0.0  0.000000    ...     17.295820  17.295820   \n",
      "142434  0.000000       0.0  0.000000    ...     23.141366  23.141366   \n",
      "179831  0.000000       0.0  0.000000    ...      1.019645   1.019645   \n",
      "275308  0.000000       0.0  0.000000    ...      1.497736   1.497736   \n",
      "200110  0.000000       0.0  0.058697    ...      1.498566   1.498566   \n",
      "185623  0.000000       0.0  0.000000    ...     16.732420  16.732420   \n",
      "14426   0.000000       0.0  0.000000    ...      1.742852   1.742852   \n",
      "11167   0.000000       0.0  0.000000    ...      1.272240   1.272240   \n",
      "61128   0.000000       0.0  0.000000    ...      2.353953   2.353953   \n",
      "1005    0.000000       0.0  0.000000    ...     20.672641  20.672641   \n",
      "47774   0.000000       0.0  0.000000    ...      4.852235   4.852235   \n",
      "278402  0.000000       0.0  0.000000    ...      3.041947   3.041947   \n",
      "227534  0.000000       0.0  0.000000    ...      7.328117   7.328117   \n",
      "284050  0.000000       0.0  0.056597    ...      1.502371   1.502371   \n",
      "43045   0.000000       0.0  0.000000    ...      9.068750   9.068750   \n",
      "58464   0.000000       0.0  0.000000    ...      0.653967   0.653967   \n",
      "125188  0.000000       0.0  0.000000    ...     14.065168  14.065168   \n",
      "158318  0.000000       0.0  0.000000    ...      1.236435   1.236435   \n",
      "164881  0.000000       0.0  0.000000    ...      7.196848   7.196848   \n",
      "294608  0.000000       0.0  0.000000    ...      1.610805   1.610805   \n",
      "139041  0.000000       0.0  0.000000    ...      8.928004   8.928004   \n",
      "86161   0.000000       0.0  0.000000    ...      1.740783   1.740783   \n",
      "\n",
      "        GenDeltaR  isSharedHit  pixel_32  pixel_33  pixel_30  pixel_31  \\\n",
      "154947   0.005391            1  0.000000  0.000000       0.0  0.000000   \n",
      "261354   0.016156            1  0.000000  0.178391       0.0  0.000000   \n",
      "234574   0.021033            1  0.000000  0.069366       0.0  0.074517   \n",
      "105238   0.012972            1  0.000000  0.000000       0.0  0.000000   \n",
      "33906    0.007875            1  0.093219  0.000000       0.0  0.000000   \n",
      "92879    0.009717            1  0.000000  0.102124       0.0  0.000000   \n",
      "244386   0.001570            1  0.000000  0.000000       0.0  0.000000   \n",
      "267040   0.042146            1  0.065382  0.110653       0.0  0.000000   \n",
      "223854   0.009917            1  0.055788  0.000000       0.0  0.000000   \n",
      "40792    0.000620            1  0.068611  0.000000       0.0  0.000000   \n",
      "46487    0.032295            1  0.000000  0.096279       0.0  0.000000   \n",
      "30017    0.064527            1  0.000000  0.000000       0.0  0.000000   \n",
      "86040    0.001346            1  0.000000  0.000000       0.0  0.000000   \n",
      "73807    0.003049            1  0.000000  0.000000       0.0  0.000000   \n",
      "298170   0.012692            1  0.057727  0.000000       0.0  0.000000   \n",
      "214106   0.002141            1  0.000000  0.000000       0.0  0.000000   \n",
      "219253   0.001307            1  0.000000  0.000000       0.0  0.000000   \n",
      "37878    0.001551            1  0.000000  0.000000       0.0  0.000000   \n",
      "257524   0.028361            1  0.000000  0.093860       0.0  0.000000   \n",
      "145120   0.002061            0  0.000000  0.000000       0.0  0.000000   \n",
      "35983    0.004160            1  0.000000  0.000000       0.0  0.000000   \n",
      "260950   0.004546            1  0.000000  0.118561       0.0  0.000000   \n",
      "226103   0.007076            1  0.000000  0.073597       0.0  0.000000   \n",
      "219705   0.002014            1  0.000000  0.073780       0.0  0.000000   \n",
      "179244   0.013121            1  0.000000  0.000000       0.0  0.000000   \n",
      "116854   0.002090            1  0.000000  0.151830       0.0  0.000000   \n",
      "63193    0.002370            0  0.000000  0.000000       0.0  0.000000   \n",
      "142081   0.002406            1  0.000000  0.000000       0.0  0.000000   \n",
      "255803   0.013691            1  0.000000  0.000000       0.0  0.000000   \n",
      "227974   0.010815            1  0.128116  0.000000       0.0  0.000000   \n",
      "...           ...          ...       ...       ...       ...       ...   \n",
      "8784     0.017620            1  0.000000  0.179317       0.0  0.000000   \n",
      "43903    0.001429            0  0.000000  0.000000       0.0  0.000000   \n",
      "31897    0.005379            1  0.080604  0.000000       0.0  0.000000   \n",
      "171029   0.006279            1  0.054803  0.000000       0.0  0.000000   \n",
      "142317   0.000437            1  0.000000  0.000000       0.0  0.000000   \n",
      "220126   0.001676            1  0.000000  0.000000       0.0  0.000000   \n",
      "18372    0.099798            1  0.076061  0.044113       0.0  0.000000   \n",
      "46206    0.018761            1  0.000000  0.000000       0.0  0.000000   \n",
      "44309    0.001178            1  0.000000  0.000000       0.0  0.000000   \n",
      "142434   0.057153            1  0.000000  0.000000       0.0  0.000000   \n",
      "179831   0.020822            1  0.000000  0.000000       0.0  0.000000   \n",
      "275308   0.045296            1  0.000000  0.000000       0.0  0.000000   \n",
      "200110   0.001767            1  0.000000  0.000000       0.0  0.000000   \n",
      "185623   0.000488            1  0.000000  0.000000       0.0  0.000000   \n",
      "14426    0.018917            1  0.000000  0.000000       0.0  0.000000   \n",
      "11167    0.009688            1  0.000000  0.000000       0.0  0.000000   \n",
      "61128    0.002829            1  0.000000  0.000000       0.0  0.000000   \n",
      "1005     0.000820            1  0.000000  0.000000       0.0  0.000000   \n",
      "47774    0.004514            1  0.000000  0.000000       0.0  0.000000   \n",
      "278402   0.010275            1  0.000000  0.000000       0.0  0.000000   \n",
      "227534   0.098326            1  0.000000  0.000000       0.0  0.000000   \n",
      "284050   0.001373            1  0.000000  0.000000       0.0  0.000000   \n",
      "43045    0.003131            1  0.000000  0.033253       0.0  0.000000   \n",
      "58464    0.013333            0  0.000000  0.000000       0.0  0.000000   \n",
      "125188   0.014168            1  0.000000  0.000000       0.0  0.000000   \n",
      "158318   0.019938            1  0.000000  0.000000       0.0  0.000000   \n",
      "164881   0.002424            1  0.000000  0.000000       0.0  0.000000   \n",
      "294608   0.005963            1  0.000000  0.077361       0.0  0.000000   \n",
      "139041   0.001972            1  0.000000  0.000000       0.0  0.000000   \n",
      "86161    0.004545            1  0.000000  0.000000       0.0  0.000000   \n",
      "\n",
      "        pixel_34  pixel_35  \n",
      "154947  0.000000       0.0  \n",
      "261354  0.000000       0.0  \n",
      "234574  0.000000       0.0  \n",
      "105238  0.000000       0.0  \n",
      "33906   0.000000       0.0  \n",
      "92879   0.000000       0.0  \n",
      "244386  0.000000       0.0  \n",
      "267040  0.000000       0.0  \n",
      "223854  0.058788       0.0  \n",
      "40792   0.000000       0.0  \n",
      "46487   0.089908       0.0  \n",
      "30017   0.000000       0.0  \n",
      "86040   0.000000       0.0  \n",
      "73807   0.000000       0.0  \n",
      "298170  0.062735       0.0  \n",
      "214106  0.000000       0.0  \n",
      "219253  0.000000       0.0  \n",
      "37878   0.000000       0.0  \n",
      "257524  0.000000       0.0  \n",
      "145120  0.000000       0.0  \n",
      "35983   0.000000       0.0  \n",
      "260950  0.000000       0.0  \n",
      "226103  0.072189       0.0  \n",
      "219705  0.000000       0.0  \n",
      "179244  0.000000       0.0  \n",
      "116854  0.000000       0.0  \n",
      "63193   0.000000       0.0  \n",
      "142081  0.000000       0.0  \n",
      "255803  0.000000       0.0  \n",
      "227974  0.000000       0.0  \n",
      "...          ...       ...  \n",
      "8784    0.000000       0.0  \n",
      "43903   0.000000       0.0  \n",
      "31897   0.123802       0.0  \n",
      "171029  0.000000       0.0  \n",
      "142317  0.000000       0.0  \n",
      "220126  0.000000       0.0  \n",
      "18372   0.000000       0.0  \n",
      "46206   0.000000       0.0  \n",
      "44309   0.000000       0.0  \n",
      "142434  0.000000       0.0  \n",
      "179831  0.000000       0.0  \n",
      "275308  0.000000       0.0  \n",
      "200110  0.000000       0.0  \n",
      "185623  0.000000       0.0  \n",
      "14426   0.000000       0.0  \n",
      "11167   0.000000       0.0  \n",
      "61128   0.000000       0.0  \n",
      "1005    0.000000       0.0  \n",
      "47774   0.000000       0.0  \n",
      "278402  0.210582       0.0  \n",
      "227534  0.000000       0.0  \n",
      "284050  0.000000       0.0  \n",
      "43045   0.000000       0.0  \n",
      "58464   0.000000       0.0  \n",
      "125188  0.000000       0.0  \n",
      "158318  0.000000       0.0  \n",
      "164881  0.000000       0.0  \n",
      "294608  0.000000       0.0  \n",
      "139041  0.000000       0.0  \n",
      "86161   0.000000       0.0  \n",
      "\n",
      "[4242 rows x 42 columns]\n"
     ]
    }
   ],
   "source": [
    "print df_train[ret_train[:,1]>.46]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        pixel_14  pixel_15  pixel_16  pixel_17  pixel_10  pixel_11  pixel_12  \\\n",
      "43018        0.0  0.111042  0.000000       0.0  0.000000       0.0       0.0   \n",
      "137849       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "157091       0.0  0.539852  0.000000       0.0  0.000000       0.0       0.0   \n",
      "17047        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "58728        0.0  0.000000  0.318711       0.0  0.000000       0.0       0.0   \n",
      "100213       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "269222       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "235587       0.0  0.202763  0.000000       0.0  0.000000       0.0       0.0   \n",
      "218780       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "261546       0.0  0.167813  0.000000       0.0  0.000000       0.0       0.0   \n",
      "35666        0.0  0.260774  0.000000       0.0  0.000000       0.0       0.0   \n",
      "179298       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "165838       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "249633       0.0  0.000000  0.226085       0.0  0.000000       0.0       0.0   \n",
      "252863       0.0  0.227935  0.000000       0.0  0.000000       0.0       0.0   \n",
      "22308        0.0  0.316567  0.000000       0.0  0.000000       0.0       0.0   \n",
      "152717       0.0  0.169292  0.000000       0.0  0.000000       0.0       0.0   \n",
      "203041       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "286163       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "94549        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "57337        0.0  0.000000  0.110485       0.0  0.000000       0.0       0.0   \n",
      "171002       0.0  0.160745  0.000000       0.0  0.000000       0.0       0.0   \n",
      "96576        0.0  0.274535  0.000000       0.0  0.000000       0.0       0.0   \n",
      "146610       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "44337        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "83475        0.0  0.284313  0.000000       0.0  0.000000       0.0       0.0   \n",
      "148576       0.0  0.067223  0.000000       0.0  0.000000       0.0       0.0   \n",
      "87637        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "160508       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "169842       0.0  0.341884  0.000000       0.0  0.000000       0.0       0.0   \n",
      "...          ...       ...       ...       ...       ...       ...       ...   \n",
      "140576       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "89369        0.0  0.386618  0.000000       0.0  0.000000       0.0       0.0   \n",
      "98100        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "37365        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "92706        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "2762         0.0  0.149290  0.000000       0.0  0.000000       0.0       0.0   \n",
      "61952        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "122362       0.0  0.066417  0.000000       0.0  0.000000       0.0       0.0   \n",
      "93666        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "60547        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "129086       0.0  0.000000  0.313409       0.0  0.000000       0.0       0.0   \n",
      "46791        0.0  0.077064  0.000000       0.0  0.000000       0.0       0.0   \n",
      "46677        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "38116        0.0  0.165031  0.000000       0.0  0.000000       0.0       0.0   \n",
      "90734        0.0  0.059279  0.000000       0.0  0.000000       0.0       0.0   \n",
      "155034       0.0  0.182028  0.000000       0.0  0.000000       0.0       0.0   \n",
      "257779       0.0  0.000000  0.392942       0.0  0.064553       0.0       0.0   \n",
      "134488       0.0  0.202334  0.000000       0.0  0.000000       0.0       0.0   \n",
      "48042        0.0  0.129947  0.000000       0.0  0.000000       0.0       0.0   \n",
      "257184       0.0  0.156109  0.000000       0.0  0.000000       0.0       0.0   \n",
      "183609       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "159776       0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "48806        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "32865        0.0  0.186727  0.000000       0.0  0.000000       0.0       0.0   \n",
      "39214        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "247541       0.0  0.229406  0.000000       0.0  0.000000       0.0       0.0   \n",
      "94578        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "86937        0.0  0.000000  0.000000       0.0  0.000000       0.0       0.0   \n",
      "137609       0.0  0.112805  0.000000       0.0  0.000000       0.0       0.0   \n",
      "171029       0.0  0.106049  0.000000       0.0  0.000000       0.0       0.0   \n",
      "\n",
      "        pixel_13  pixel_18  pixel_19    ...      trackPhi    trackPt  \\\n",
      "43018        0.0       0.0       0.0    ...     39.549280  39.549280   \n",
      "137849       0.0       0.0       0.0    ...      4.054901   4.054901   \n",
      "157091       0.0       0.0       0.0    ...      1.706806   1.706806   \n",
      "17047        0.0       0.0       0.0    ...     13.455184  13.455184   \n",
      "58728        0.0       0.0       0.0    ...      6.350341   6.350341   \n",
      "100213       0.0       0.0       0.0    ...     11.459966  11.459966   \n",
      "269222       0.0       0.0       0.0    ...      2.824173   2.824173   \n",
      "235587       0.0       0.0       0.0    ...      1.848395   1.848395   \n",
      "218780       0.0       0.0       0.0    ...      6.111817   6.111817   \n",
      "261546       0.0       0.0       0.0    ...     11.079543  11.079543   \n",
      "35666        0.0       0.0       0.0    ...      3.773842   3.773842   \n",
      "179298       0.0       0.0       0.0    ...     20.120247  20.120247   \n",
      "165838       0.0       0.0       0.0    ...      1.814279   1.814279   \n",
      "249633       0.0       0.0       0.0    ...      0.533004   0.533004   \n",
      "252863       0.0       0.0       0.0    ...      2.417066   2.417066   \n",
      "22308        0.0       0.0       0.0    ...      1.783327   1.783327   \n",
      "152717       0.0       0.0       0.0    ...      1.344821   1.344821   \n",
      "203041       0.0       0.0       0.0    ...      1.605429   1.605429   \n",
      "286163       0.0       0.0       0.0    ...      0.426627   0.426627   \n",
      "94549        0.0       0.0       0.0    ...      3.562849   3.562849   \n",
      "57337        0.0       0.0       0.0    ...     12.048514  12.048514   \n",
      "171002       0.0       0.0       0.0    ...      9.749179   9.749179   \n",
      "96576        0.0       0.0       0.0    ...      2.050088   2.050088   \n",
      "146610       0.0       0.0       0.0    ...     12.583173  12.583173   \n",
      "44337        0.0       0.0       0.0    ...      8.525088   8.525088   \n",
      "83475        0.0       0.0       0.0    ...     15.385863  15.385863   \n",
      "148576       0.0       0.0       0.0    ...      5.871844   5.871844   \n",
      "87637        0.0       0.0       0.0    ...      1.998612   1.998612   \n",
      "160508       0.0       0.0       0.0    ...      0.842093   0.842093   \n",
      "169842       0.0       0.0       0.0    ...      1.197861   1.197861   \n",
      "...          ...       ...       ...    ...           ...        ...   \n",
      "140576       0.0       0.0       0.0    ...     12.712571  12.712571   \n",
      "89369        0.0       0.0       0.0    ...     10.929102  10.929102   \n",
      "98100        0.0       0.0       0.0    ...      2.779916   2.779916   \n",
      "37365        0.0       0.0       0.0    ...      9.121710   9.121710   \n",
      "92706        0.0       0.0       0.0    ...     15.935590  15.935590   \n",
      "2762         0.0       0.0       0.0    ...      1.480155   1.480155   \n",
      "61952        0.0       0.0       0.0    ...     14.836296  14.836296   \n",
      "122362       0.0       0.0       0.0    ...      2.576840   2.576840   \n",
      "93666        0.0       0.0       0.0    ...      2.617995   2.617995   \n",
      "60547        0.0       0.0       0.0    ...      7.703036   7.703036   \n",
      "129086       0.0       0.0       0.0    ...      3.614829   3.614829   \n",
      "46791        0.0       0.0       0.0    ...     26.027435  26.027435   \n",
      "46677        0.0       0.0       0.0    ...     25.780879  25.780879   \n",
      "38116        0.0       0.0       0.0    ...      2.762013   2.762013   \n",
      "90734        0.0       0.0       0.0    ...      2.579048   2.579048   \n",
      "155034       0.0       0.0       0.0    ...      5.818430   5.818430   \n",
      "257779       0.0       0.0       0.0    ...      1.245096   1.245096   \n",
      "134488       0.0       0.0       0.0    ...      5.765229   5.765229   \n",
      "48042        0.0       0.0       0.0    ...      3.324475   3.324475   \n",
      "257184       0.0       0.0       0.0    ...      9.600105   9.600105   \n",
      "183609       0.0       0.0       0.0    ...     16.763321  16.763321   \n",
      "159776       0.0       0.0       0.0    ...      2.642770   2.642770   \n",
      "48806        0.0       0.0       0.0    ...      2.709706   2.709706   \n",
      "32865        0.0       0.0       0.0    ...      2.594548   2.594548   \n",
      "39214        0.0       0.0       0.0    ...      1.450230   1.450230   \n",
      "247541       0.0       0.0       0.0    ...      2.138153   2.138153   \n",
      "94578        0.0       0.0       0.0    ...     23.381493  23.381493   \n",
      "86937        0.0       0.0       0.0    ...     12.987747  12.987747   \n",
      "137609       0.0       0.0       0.0    ...      8.073463   8.073463   \n",
      "171029       0.0       0.0       0.0    ...     16.713398  16.713398   \n",
      "\n",
      "        GenDeltaR  isSharedHit  pixel_32  pixel_33  pixel_30  pixel_31  \\\n",
      "43018    0.082892            1  0.000000  0.000000       0.0       0.0   \n",
      "137849   0.005523            0  0.000000  0.000000       0.0       0.0   \n",
      "157091   0.029686            1  0.000000  0.000000       0.0       0.0   \n",
      "17047    0.000620            1  0.000000  0.000000       0.0       0.0   \n",
      "58728    0.023307            1  0.000000  0.000000       0.0       0.0   \n",
      "100213   0.058599            1  0.000000  0.000000       0.0       0.0   \n",
      "269222   0.005293            1  0.000000  0.000000       0.0       0.0   \n",
      "235587   0.004414            1  0.000000  0.000000       0.0       0.0   \n",
      "218780   0.001217            1  0.000000  0.000000       0.0       0.0   \n",
      "261546   0.048595            1  0.000000  0.160738       0.0       0.0   \n",
      "35666    0.006008            1  0.000000  0.000000       0.0       0.0   \n",
      "179298   0.001488            1  0.000000  0.000000       0.0       0.0   \n",
      "165838   0.013139            1  0.000000  0.000000       0.0       0.0   \n",
      "249633   0.078857            0  0.000000  0.000000       0.0       0.0   \n",
      "252863   0.004628            1  0.000000  0.000000       0.0       0.0   \n",
      "22308    0.003871            1  0.000000  0.000000       0.0       0.0   \n",
      "152717   0.068875            1  0.000000  0.096857       0.0       0.0   \n",
      "203041   0.030261            1  0.000000  0.000000       0.0       0.0   \n",
      "286163   0.023395            0  0.000000  0.000000       0.0       0.0   \n",
      "94549    0.009901            1  0.000000  0.000000       0.0       0.0   \n",
      "57337    0.000454            1  0.000000  0.000000       0.0       0.0   \n",
      "171002   0.000352            1  0.000000  0.000000       0.0       0.0   \n",
      "96576    0.002992            1  0.000000  0.000000       0.0       0.0   \n",
      "146610   0.065849            1  0.000000  0.000000       0.0       0.0   \n",
      "44337    0.000753            1  0.000000  0.000000       0.0       0.0   \n",
      "83475    0.052773            1  0.000000  0.164843       0.0       0.0   \n",
      "148576   0.048474            1  0.000000  0.000000       0.0       0.0   \n",
      "87637    0.092110            1  0.000000  0.000000       0.0       0.0   \n",
      "160508   0.007819            0  0.000000  0.000000       0.0       0.0   \n",
      "169842   0.011437            1  0.000000  0.161450       0.0       0.0   \n",
      "...           ...          ...       ...       ...       ...       ...   \n",
      "140576   0.000517            1  0.000000  0.000000       0.0       0.0   \n",
      "89369    0.049781            1  0.000000  0.000000       0.0       0.0   \n",
      "98100    0.051472            1  0.000000  0.000000       0.0       0.0   \n",
      "37365    0.002041            1  0.000000  0.000000       0.0       0.0   \n",
      "92706    0.001484            1  0.000000  0.000000       0.0       0.0   \n",
      "2762     0.032754            1  0.000000  0.101751       0.0       0.0   \n",
      "61952    0.001401            1  0.000000  0.000000       0.0       0.0   \n",
      "122362   0.004441            1  0.000000  0.000000       0.0       0.0   \n",
      "93666    0.001522            1  0.000000  0.000000       0.0       0.0   \n",
      "60547    0.096947            1  0.000000  0.000000       0.0       0.0   \n",
      "129086   0.008793            1  0.000000  0.095893       0.0       0.0   \n",
      "46791    0.001166            1  0.101140  0.000000       0.0       0.0   \n",
      "46677    0.068358            1  0.000000  0.000000       0.0       0.0   \n",
      "38116    0.001459            1  0.000000  0.000000       0.0       0.0   \n",
      "90734    0.003672            1  0.000000  0.000000       0.0       0.0   \n",
      "155034   0.069576            1  0.000000  0.000000       0.0       0.0   \n",
      "257779   0.039725            1  0.000000  0.000000       0.0       0.0   \n",
      "134488   0.006001            1  0.000000  0.000000       0.0       0.0   \n",
      "48042    0.053834            1  0.000000  0.342541       0.0       0.0   \n",
      "257184   0.003206            1  0.000000  0.244365       0.0       0.0   \n",
      "183609   0.000665            1  0.000000  0.000000       0.0       0.0   \n",
      "159776   0.006381            0  0.000000  0.000000       0.0       0.0   \n",
      "48806    0.014491            1  0.000000  0.000000       0.0       0.0   \n",
      "32865    0.006133            1  0.000000  0.000000       0.0       0.0   \n",
      "39214    0.099412            1  0.000000  0.000000       0.0       0.0   \n",
      "247541   0.002589            1  0.000000  0.000000       0.0       0.0   \n",
      "94578    0.044787            1  0.000000  0.000000       0.0       0.0   \n",
      "86937    0.002870            1  0.000000  0.000000       0.0       0.0   \n",
      "137609   0.027580            1  0.000000  0.000000       0.0       0.0   \n",
      "171029   0.006279            1  0.054803  0.000000       0.0       0.0   \n",
      "\n",
      "        pixel_34  pixel_35  \n",
      "43018        0.0       0.0  \n",
      "137849       0.0       0.0  \n",
      "157091       0.0       0.0  \n",
      "17047        0.0       0.0  \n",
      "58728        0.0       0.0  \n",
      "100213       0.0       0.0  \n",
      "269222       0.0       0.0  \n",
      "235587       0.0       0.0  \n",
      "218780       0.0       0.0  \n",
      "261546       0.0       0.0  \n",
      "35666        0.0       0.0  \n",
      "179298       0.0       0.0  \n",
      "165838       0.0       0.0  \n",
      "249633       0.0       0.0  \n",
      "252863       0.0       0.0  \n",
      "22308        0.0       0.0  \n",
      "152717       0.0       0.0  \n",
      "203041       0.0       0.0  \n",
      "286163       0.0       0.0  \n",
      "94549        0.0       0.0  \n",
      "57337        0.0       0.0  \n",
      "171002       0.0       0.0  \n",
      "96576        0.0       0.0  \n",
      "146610       0.0       0.0  \n",
      "44337        0.0       0.0  \n",
      "83475        0.0       0.0  \n",
      "148576       0.0       0.0  \n",
      "87637        0.0       0.0  \n",
      "160508       0.0       0.0  \n",
      "169842       0.0       0.0  \n",
      "...          ...       ...  \n",
      "140576       0.0       0.0  \n",
      "89369        0.0       0.0  \n",
      "98100        0.0       0.0  \n",
      "37365        0.0       0.0  \n",
      "92706        0.0       0.0  \n",
      "2762         0.0       0.0  \n",
      "61952        0.0       0.0  \n",
      "122362       0.0       0.0  \n",
      "93666        0.0       0.0  \n",
      "60547        0.0       0.0  \n",
      "129086       0.0       0.0  \n",
      "46791        0.0       0.0  \n",
      "46677        0.0       0.0  \n",
      "38116        0.0       0.0  \n",
      "90734        0.0       0.0  \n",
      "155034       0.0       0.0  \n",
      "257779       0.0       0.0  \n",
      "134488       0.0       0.0  \n",
      "48042        0.0       0.0  \n",
      "257184       0.0       0.0  \n",
      "183609       0.0       0.0  \n",
      "159776       0.0       0.0  \n",
      "48806        0.0       0.0  \n",
      "32865        0.0       0.0  \n",
      "39214        0.0       0.0  \n",
      "247541       0.0       0.0  \n",
      "94578        0.0       0.0  \n",
      "86937        0.0       0.0  \n",
      "137609       0.0       0.0  \n",
      "171029       0.0       0.0  \n",
      "\n",
      "[180 rows x 42 columns]\n"
     ]
    }
   ],
   "source": [
    "print df_train[(ret_train[:,1]>.46) & (ret_train[:,1]<.5)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Text(0.5,1,'CNN Signal and Background')"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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Y8jJyeHBBx+srv+Xv/xlRo4cyYknnsg//vEPZs6cyeeff87IkSOZ7h9+TJ06laJEfhJFQqagAPbtiy7bt88rTxT175to4sSJ3H777QwePJgzzzyTCy+8kPHjx0fFbN26lTvuuIMVK1bQo0cPzjjjDEaMGFH9+LZt21i8eDGrV69m8uTJTJs2jfT0dP70pz/Rs2dPPv74Y8aOHcvkyZPrPdl54MAB1q9fT9VkeXfddRc/+9nPeP755wEoLCwkIyODt956i/379zNu3DgmTpzIM888w1lnnUVBQQGVlZXs27eP008/nfvuu4+VK1dWr//EE0/krbfeivOrJyJVNm1qWnlrUA+gibp3787y5cspLCykT58+XHjhhcydOzcq5s0332T8+PH07t2bTp06ccEFF0Q9PnXqVFJSUhg6dCjbt28HvGvbb731VnJycjjzzDP58MMPqx+L5eOPP6ZXr171Pv73v/+dRx55hJEjR3LKKaewc+dO1q1bx5gxY/jd737HrFmzePfdd+nRo0fM56emptK5c2f27NkT8JURkabo379p5a1BPYBmSE1NJS8vj7y8PIYPH868efPIz8+vfryxm+xUDR9FxhYVFbFjxw6WL19Op06dyM7ObvA6965duzb4uHOOX//615x11ll1Hnv11Vf5y1/+Qn5+PjfddBOXXnppzHXs37+f9PT0BvdFRJpn9mxvzD9yGKhbN688UdQDaKI1a9awbt266uWVK1cyYMCAqJjc3FwWLVrEJ598QkVFBU8//XSj6y0rK6Nv37506tSJV155hdLShmdzPfzww6msrKxOAj169Ig6Wj/rrLN44IEHOHjwIABr167ls88+o7S0lL59+3LVVVdx5ZVXsmLFCgA6depUHQuwc+dO+vTpo6kWRFrJ9OlQWAgDBoCZ97uwMLFXAbX7HkC8LwNtzN69e/n2t7/N7t27SUtL47jjjqOwsDAq5uijj+bWW28lNzeX3r17M2TIEDIyMhpc7/Tp0zn33HMZPnw4o0ePZsiQIY3WZeLEiSxevJgzzzyTnJwc0tLSGDFiBPn5+dx4441s3LiRUaNG4ZyjT58+/PnPf6a4uJif/vSndOrUie7du/PII48AMGPGDHJychg1ahRFRUW88sornH322c1/oUSkUdOnJ7bBr8M512Z/Tj75ZFfbqlWr6pS1RXv27HHOOXfw4EF3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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Signal and background plot \n",
    "plt.hist(signal_plt, alpha = 0.5, color = 'b', label = 'Signal (test)', range = (0,1), bins = 30)\n",
    "plt.hist(background_plt, color = 'r', alpha = 0.5, label = 'Background (test)', range = (0,1), bins = 30)\n",
    "plt.scatter(X_back_hist[0:30] + 0.0166 , Y_back_hist, label='Background (train)', color ='r')\n",
    "plt.scatter(X_sig_hist[0:30] + 0.0166, Y_sig_hist, label='Signal (train)', color='b')\n",
    "plt.legend(loc='best')\n",
    "plt.title('CNN Signal and Background')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 2",
   "language": "python",
   "name": "python2"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.15"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
